{"version":3,"sources":["demo/footer.js","demo/header.js","section.js","index.js"],"names":["DemoFooter","props","view","state","className","href","target","React","Component","DemoHeader","title","this","Section","demo3","content","settings","pieceLayout","sectionTitle","renderTitle","sectionText","renderText","sectionLink","renderLink","fullWidthImage","pieceImage","renderImage","pieceText","showPieceImage","showPieceText","image","localeContent","Image","showImage","imageTitle","Title","imageLink","link","imageSrc","SERVER_IMAGE","classFull","src","alt","Link","showLink","linkUri","URI","linkText","Text","text","showText","dangerouslySetInnerHTML","__html","hsize","visualOption","show","linkOption","showTitle","textOption","Demo3","contextPath","document","getElementById","dataset","SERVER","process","ENDPOINT","PARAMS","page","loadPage","self","url","fetch","then","response","json","setState","containers","visitContainers","type","attributes","container","elements","visitElements","map","visitContainer","element","formatterKey","path","linkedContents","length","endsWith","renderContent","idx","visitElement","ReactDOM","render"],"mappings":"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","file":"static/js/main.6ab48a88.chunk.js","sourcesContent":["import React from 'react';\n\nclass DemoFooter extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.view = props.view;\n    this.state = props.state;\n  }\n\n  render() {\n    return (\n      <footer>\n        <div>\n          <h4>Demo using the OpenCms JSON API.</h4>\n          <div className=\"flex column\">\n            <a href=\"https://documentation.opencms.org/opencms-documentation/more-opencms-features/json-api/\"\n               target=\"_blank\"\n               className=\"doc\">Read the API Documentation</a>\n            <a href=\"https://github.com/alkacon/mercury-json\"\n               target=\"_blank\"\n               className=\"github\">View the Demo Source on GitHub</a>\n          </div>\n        </div>\n      </footer>\n    )\n  }\n}\n\nexport default DemoFooter;\n","import React from 'react';\n\nclass DemoHeader extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.title = props.title;\n  }\n\n  render() {\n    return (\n      <header>\n        <h1>{this.title}</h1>\n        <h4>\n          <span>A demo single page application using </span>\n          <a href=\"#\">OpenCms</a>.\n        </h4>\n      </header>\n    )\n  }\n}\n\nexport default DemoHeader;\n","import React from 'react';\n\n/**\n * Class representing a section component.\n */\nclass Section extends React.Component {\n\n  /**\n   * Creates a new component.\n   */\n  constructor(props) {\n    super(props);\n    /** The demo 3 application. */\n    this.demo3 = props.demo3;\n    /** The content to render. */\n    this.content = props.content;\n    /** The formatter settings. */\n    this.settings = props.settings;\n  }\n\n  /**\n   * Renders this component according to formatter settings.\n   */\n  render() {\n    const pieceLayout = this.settings.pieceLayout;\n    const sectionTitle = this.renderTitle();\n    const sectionText = this.renderText();\n    const sectionLink = this.renderLink();\n    const fullWidthImage = !(sectionTitle && sectionText && sectionLink);\n    const pieceImage = this.renderImage(fullWidthImage);\n    const pieceText = (\n      <div>\n      {sectionTitle}\n      {sectionText}\n      {sectionLink}\n      </div>\n    )\n    if (pieceLayout === '6') { // image left, text right\n      return (\n        <div className=\"list\">\n        {this.showPieceImage() ? pieceImage : false}\n        {this.showPieceText() ? pieceText : false}\n        </div>\n      )\n    } else if (pieceLayout === '7') { // text left, image right\n      return (\n        <div className=\"list\">\n        {this.showPieceText() ? pieceText : false}\n        {this.showPieceImage() ? pieceImage : false}\n        </div>\n      )\n    }\n    return (\n      <div>Unknown pieceLayout setting: {pieceLayout}.</div>\n    )\n  }\n\n  /**\n   * Renders the image of this section.\n   */\n  renderImage(fullWidthImage) {\n    const image = this.content.localeContent.Image;\n    if (this.showImage() && image) {\n      const imageTitle = image.Title;\n      const imageLink = image.Image.link;\n      const imageSrc = this.demo3.SERVER_IMAGE + imageLink;\n      const classFull = fullWidthImage ? 'full' : null;\n      return (\n        <img src={imageSrc} alt={imageTitle} className={classFull}/>\n      )\n    }\n    return false;\n  }\n\n  /**\n   * Renders the link of this section.\n   */\n  renderLink() {\n    const link = this.content.localeContent.Link;\n    if (this.showLink() && link) {\n      const linkUri = '#' + link.URI.link;\n      const linkText = link.Text;\n      return (\n        <a href={linkUri}>{linkText}</a>\n      )\n    }\n    return false;\n  }\n\n  /**\n   * Renders the text of this section.\n   */\n  renderText() {\n    const text = this.content.localeContent.Text;\n    if (this.showText()) {\n      return (\n        <div dangerouslySetInnerHTML={{__html: text}}></div>\n      )\n    }\n    return false;\n  }\n\n  /**\n   * Renders the title of this section.\n   */\n  renderTitle() {\n    const title = this.content.localeContent.Title;\n    const hsize = this.settings.hsize;\n    if (hsize === '1') {\n      return (\n        <h1>{title}</h1>\n      )\n    } else if (hsize === '2') {\n      return (\n        <h2>{title}</h2>\n      )\n    } else if (hsize === '3') {\n      return (\n        <h3>{title}</h3>\n      )\n    } else if (hsize === '4') {\n      return (\n        <h4>{title}</h4>\n      )\n    } else if (hsize === '0') {\n      return false;\n    }\n    return (\n      <h2>Title</h2>\n    )\n  }\n\n  /**\n   * Whether to show the image of this section according to the settings.\n   */\n  showImage() {\n    const visualOption = this.settings.visualOption;\n    let show = true;\n    if (visualOption === '99') {\n      show = true;\n    } else if (visualOption === '0') {\n      show = false;\n    }\n    return show;\n  }\n\n  /**\n   * Whether to show the link of this section according to the settings.\n   */\n  showLink() {\n    const linkOption = this.settings.linkOption;\n    let show = true;\n    if (linkOption === 'button') {\n      show = true;\n    } else if (linkOption === 'none') {\n      show = false;\n    }\n    return show;\n  }\n\n  /**\n   * Whether to show the image piece of this section. Same as showImage().\n   */\n  showPieceImage() {\n    return this.showImage();\n  }\n\n  /**\n   * Whether to show the text piece of this section. True\n   * if either the text, the title, or the link is shown.\n   */\n  showPieceText() {\n    return this.showLink() || this.showText() || this.showTitle();\n  }\n\n  /**\n   * Whether to show the text of this section according to the settings.\n   */\n  showText() {\n    const textOption = this.settings.textOption;\n    let show = true;\n    if (textOption === 'default') {\n      show = true;\n    } else if (textOption === 'none') {\n      show = false;\n    }\n    return show;\n  }\n\n  /**\n   * Whether to show the title of this section according to the settings.\n   */\n  showTitle() {\n    const hsize = this.settings.hsize;\n    return hsize !== '0';\n  }\n}\n\nexport default Section;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport DemoFooter from './demo/footer';\nimport DemoHeader from './demo/header';\nimport Section from './section'\nimport './index.css';\n\n/**\n * Class representing the demo 3 component.\n */\nclass Demo3 extends React.Component {\n\n  /**\n   * Creates a new component.\n   */\n  constructor(props) {\n    super(props);\n    const contextPath = document.getElementById('root').dataset.contextPath;\n    /** The server URL with context path. */\n    this.SERVER = contextPath === '${pageContext.request.contextPath}' ?\n        process.env.REACT_APP_OPENCMS_SERVER : contextPath;\n    /** The server URL without context path useful to link images. */\n    this.SERVER_IMAGE = process.env.REACT_APP_OPENCMS_SERVER_IMAGE;\n    /** The JSON endpoint. */\n    this.ENDPOINT = this.SERVER + '/json';\n    /** The URI of the page we will render. */\n    this.URI = '/sites/default/mercury-json/demo-3/page-editor/index.html';\n    /** The request parameters. */\n    this.PARAMS = '?content&wrapper&locale=en&fallbackLocale';\n    /** The state of this component. */\n    this.state = {\n      page: null\n    }\n  }\n\n  /**\n   * Handler. Called when this component did mount.\n   */\n  componentDidMount() {\n    this.loadPage();\n  }\n\n  /**\n   * Loads the page.\n   */\n  loadPage() {\n    const self = this;\n    const url = this.ENDPOINT + this.URI + this.PARAMS;\n    fetch(url)\n      .then(response => response.json())\n      .then((page) => {\n        self.setState({\n          page: page\n        });\n      });\n  }\n\n  /**\n   * Renders this component.\n   */\n  render() {\n    if (!this.state.page) {\n      return false;\n    }\n    const containers = this.state.page.containers;\n    return (\n      <main>\n        <div className=\"container\">\n          <DemoHeader title=\"Demo 3\"/>\n          {this.visitContainers(containers)}\n          <DemoFooter />\n        </div>\n      </main>\n    )\n  }\n\n  /**\n   * Renders a content.\n   */\n  renderContent(content, settings) {\n    const type = content.attributes.type;\n    if (type === 'm-section') {\n      return (\n        <Section demo3={this} content={content} settings={settings}/>\n      )\n    } else {\n      return (\n        <div>Content type {type} is not supported.</div>\n      )\n    }\n  }\n\n  /**\n   * Visits a container.\n   */\n  visitContainer(container) {\n    const elements = container.elements;\n    return this.visitElements(elements);\n  }\n\n  /**\n   * Visit all containers of a page or an element.\n   */\n  visitContainers(containers) {\n    const self = this;\n    const html = containers.map(container => {\n      return self.visitContainer(container);\n    });\n    return html;\n  }\n\n  /**\n   * Visits an element. If the element has containers, visit them.\n   * If the element has no containers, render the content.\n   */\n  visitElement(element) {\n    const containers = element.containers;\n    const formatterKey = element.formatterKey;\n    const path = element.path;\n    const content = this.state.page.linkedContents[path];\n    const settings = element.settings;\n    if (containers.length) {\n      return this.visitContainers(containers);\n    } else if (formatterKey && formatterKey.endsWith('/json')) {\n      return this.renderContent(content, settings);\n    } else {\n      return false;\n    }\n  }\n\n  /**\n   * Visit all elements of a container.\n   */\n  visitElements(elements) {\n    const self = this;\n    const html = elements.map((element, idx) => {\n      return self.visitElement(element);\n    });\n    return html;\n  }\n}\n\n/**\n * Render the demo 3 application.\n */\nReactDOM.render(\n  <Demo3/>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}